(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[972],{2709:function(e,t,r){Promise.resolve().then(r.bind(r,4217))},4217:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r(7437),a=r(6727),o=r(7727),i=r(4033),l=r(2265),u=r(1396),s=r.n(u);function c(){let{theme:e,toggleTheme:t}=(0,a.useTheme)(),r=(0,i.usePathname)();return(0,n.jsx)("nav",{className:"dark"===e?"fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700":"fixed bottom-0 left-0 right-0 bg-white border-t border-[#DBEAFE] shadow-lg",children:(0,n.jsxs)("div",{className:"max-w-2xl mx-auto flex justify-between items-center p-4",children:[[{icon:"\uD83C\uDFE0",href:"/user/home",label:"ホーム"},{icon:"\uD83D\uDCDA",href:"/user/courses",label:"コース"},{icon:"\uD83C\uDFC6",href:"/user/ranking",label:"ランキング"},{icon:"\uD83D\uDCAD",href:"/user/forum",label:"フォーラム"},{icon:"\uD83D\uDECD️",href:"/user/shop",label:"ショップ"}].map(t=>(0,n.jsx)(s(),{href:t.href,className:"text-2xl ".concat(r===t.href?"dark"===e?"text-blue-400":"text-[#3B82F6]":"dark"===e?"text-gray-400":"text-gray-600"," hover:opacity-80 transition-opacity"),children:(0,n.jsx)("span",{role:"img","aria-label":t.label,children:t.icon})},t.href)),(0,n.jsx)("button",{onClick:t,className:"text-2xl ".concat("dark"===e?"text-gray-400":"text-gray-600"," hover:opacity-80 transition-opacity"),children:"dark"===e?"\uD83C\uDF19":"☀️"})]})})}function d(e){let{children:t}=e,{theme:r}=(0,a.useTheme)(),{user:u}=(0,o.a)(),s=(0,i.useRouter)();return((0,l.useEffect)(()=>{u?"退会者"===u.rank&&s.push("/login"):s.push("/login")},[u]),u&&"退会者"!==u.rank)?(0,n.jsxs)("div",{className:"min-h-screen pb-20 ".concat("dark"===r?"bg-gray-900 text-white":"bg-[#F8FAFC] text-[#1E40AF]"),children:[(0,n.jsx)("main",{className:"max-w-7xl mx-auto px-4",children:t}),(0,n.jsx)(c,{})]}):null}},6727:function(e,t,r){"use strict";r.r(t),r.d(t,{ThemeProvider:function(){return i},useTheme:function(){return l}});var n=r(7437),a=r(2265);let o=(0,a.createContext)({theme:"light",device:"desktop",toggleTheme:()=>{}});function i(e){let{children:t}=e,[r,i]=(0,a.useState)("light"),[l,u]=(0,a.useState)("desktop"),[s,c]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{c(!0);let e=localStorage.getItem("theme");e&&(i(e),document.documentElement.className=e);let t=()=>{u(window.innerWidth<768?"mobile":"desktop")};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),s)?(0,n.jsx)(o.Provider,{value:{theme:r,device:l,toggleTheme:()=>{let e="dark"===r?"light":"dark";i(e),localStorage.setItem("theme",e),document.documentElement.className=e}},children:t}):null}function l(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},8096:function(e,t,r){"use strict";var n=r(2698);let a=n.Z.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),a.interceptors.response.use(e=>e,async e=>{var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){localStorage.removeItem("auth_token");let e=window.location.pathname;"/login"!==e&&"/"!==e&&(window.location.href="/login")}return Promise.reject(e)}),t.Z=a},7727:function(e,t,r){"use strict";r.d(t,{a:function(){return h}});var n,a=r(2265);let o=e=>{let t;let r=new Set,n=(e,n)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=n?n:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,o={setState:n,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(n,a,o);return o},i=e=>e?o(e):o,l=e=>e,u=e=>{let t=i(e),r=e=>(function(e,t=l){let r=a.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return a.useDebugValue(r),r})(t,e);return Object.assign(r,t),r};var s=r(8096);let c=e=>["お試し","退会者","初伝","中伝","奥伝","皆伝","管理者"].includes(e),d=e=>{if(!e.rank||!c(e.rank))throw Error("Invalid user rank");return{id:e.id,email:e.email,name:e.name,rank:e.rank,mongoId:e.mongoId}},h=(n=e=>({user:null,loading:!1,error:null,initialized:!1,login:async(t,r)=>{e({loading:!0,error:null});try{let n;n=r?await s.Z.post("/auth/login",{email:t,password:r}):await s.Z.get("/auth/verify",{headers:{Authorization:"Bearer ".concat(t)}});let{success:a,token:o,user:i}=n.data;if(a&&o&&i){let t=d(i);return localStorage.setItem("auth_token",o),e({user:t,loading:!1,error:null}),!0}return e({error:n.data.message||"認証に失敗しました",loading:!1}),!1}catch(t){return localStorage.removeItem("auth_token"),e({user:null,error:"認証に失敗しました",loading:!1}),!1}},logout:()=>{localStorage.removeItem("auth_token"),e({user:null,loading:!1,error:null})},setInitialized:t=>e({initialized:t})}))?u(n):u},4033:function(e,t,r){e.exports=r(8165)}},function(e){e.O(0,[829,176,971,596,744],function(){return e(e.s=2709)}),_N_E=e.O()}]);