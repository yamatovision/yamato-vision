(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9316:function(e,t,r){Promise.resolve().then(r.bind(r,6907)),Promise.resolve().then(r.bind(r,6727)),Promise.resolve().then(r.bind(r,4058)),Promise.resolve().then(r.t.bind(r,6579,23))},6907:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return i}});var n=r(7437),o=r(2265),l=r(7727);function i(e){let{children:t}=e,{login:r,logout:i,initialized:a,setInitialized:s}=(0,l.a)();return((0,o.useEffect)(()=>{let e=async()=>{let e=localStorage.getItem("auth_token");if(e)try{let t=await r(e);t||i()}catch(e){i()}s(!0)};e()},[r,i,s]),a)?(0,n.jsx)(n.Fragment,{children:t}):null}},6727:function(e,t,r){"use strict";r.r(t),r.d(t,{ThemeProvider:function(){return i},useTheme:function(){return a}});var n=r(7437),o=r(2265);let l=(0,o.createContext)({theme:"light",device:"desktop",toggleTheme:()=>{}});function i(e){let{children:t}=e,[r,i]=(0,o.useState)("light"),[a,s]=(0,o.useState)("desktop"),[u,c]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{c(!0);let e=localStorage.getItem("theme");e&&(i(e),document.documentElement.className=e);let t=()=>{s(window.innerWidth<768?"mobile":"desktop")};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),u)?(0,n.jsx)(l.Provider,{value:{theme:r,device:a,toggleTheme:()=>{let e="dark"===r?"light":"dark";i(e),localStorage.setItem("theme",e),document.documentElement.className=e}},children:t}):null}function a(){let e=(0,o.useContext)(l);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},4058:function(e,t,r){"use strict";r.r(t),r.d(t,{ToastProvider:function(){return a},useToast:function(){return s}});var n=r(7437),o=r(2265);function l(e){let{message:t,type:r,onClose:o,levelUpData:l}=e,i="p-4 rounded-md shadow-lg flex items-center justify-between",a={success:"bg-green-500 text-white",error:"bg-red-500 text-white",info:"bg-blue-500 text-white",warning:"bg-yellow-500 text-white",levelUp:"bg-gradient-to-r from-yellow-600 to-yellow-400 text-white"};return"levelUp"===r&&l?(0,n.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50",onClick:o,children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),(0,n.jsx)("div",{className:"".concat(i," ").concat(a[r]," transform transition-all duration-300 scale-100 hover:scale-105"),children:(0,n.jsxs)("div",{className:"text-center w-full",children:[(0,n.jsx)("div",{className:"text-4xl font-bold mb-4",children:"\uD83C\uDF8A Level Up! \uD83C\uDF8A"}),(0,n.jsxs)("div",{className:"text-5xl font-bold mb-4",children:["Lv.",l.newLevel]}),l.specialUnlock?(0,n.jsxs)("div",{className:"text-lg bg-yellow-700 rounded-lg p-3 mt-4 mb-4",children:["\uD83C\uDF89 ",l.specialUnlock," \uD83C\uDF89"]}):(0,n.jsx)("div",{className:"text-lg bg-yellow-700 rounded-lg p-3 mt-4 mb-4",children:"\uD83C\uDF89 おめでとうございます！！ \uD83C\uDF89"}),(0,n.jsx)("div",{className:"text-sm text-yellow-100 mt-4",children:"クリックして閉じる"})]})})]}):(0,n.jsxs)("div",{className:"".concat(i," ").concat(a[r]),children:[(0,n.jsx)("span",{children:t}),(0,n.jsx)("button",{onClick:o,className:"ml-4 text-white hover:text-gray-200",children:"\xd7"})]})}let i=(0,o.createContext)(void 0);function a(e){let{children:t}=e,[r,a]=(0,o.useState)([]);return(0,n.jsxs)(i.Provider,{value:{showToast:(e,t,r)=>{let n=Date.now();a(o=>[...o,{id:n,message:e,type:t,levelUpData:r}]),"levelUp"!==t&&setTimeout(()=>{a(e=>e.filter(e=>e.id!==n))},3e3)}},children:[t,(0,n.jsx)("div",{className:"fixed bottom-4 right-4 z-50 space-y-2",children:r.map(e=>(0,n.jsx)(l,{message:e.message,type:e.type,levelUpData:e.levelUpData,onClose:()=>a(t=>t.filter(t=>t.id!==e.id))},e.id))})]})}function s(){let e=(0,o.useContext)(i);if(void 0===e)throw Error("useToast must be used within a ToastProvider");return e}},8096:function(e,t,r){"use strict";var n=r(2698);let o=n.Z.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),o.interceptors.response.use(e=>e,async e=>{var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){localStorage.removeItem("auth_token");let e=window.location.pathname;"/login"!==e&&"/"!==e&&(window.location.href="/login")}return Promise.reject(e)}),t.Z=o},7727:function(e,t,r){"use strict";r.d(t,{a:function(){return m}});var n,o=r(2265);let l=e=>{let t;let r=new Set,n=(e,n)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=n?n:"object"!=typeof o||null===o)?o:Object.assign({},t,o),r.forEach(r=>r(t,e))}},o=()=>t,l={setState:n,getState:o,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(n,o,l);return l},i=e=>e?l(e):l,a=e=>e,s=e=>{let t=i(e),r=e=>(function(e,t=a){let r=o.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return o.useDebugValue(r),r})(t,e);return Object.assign(r,t),r};var u=r(8096);let c=e=>["お試し","退会者","初伝","中伝","奥伝","皆伝","管理者"].includes(e),d=e=>{if(!e.rank||!c(e.rank))throw Error("Invalid user rank");return{id:e.id,email:e.email,name:e.name,rank:e.rank,mongoId:e.mongoId}},m=(n=e=>({user:null,loading:!1,error:null,initialized:!1,login:async(t,r)=>{e({loading:!0,error:null});try{let n;n=r?await u.Z.post("/auth/login",{email:t,password:r}):await u.Z.get("/auth/verify",{headers:{Authorization:"Bearer ".concat(t)}});let{success:o,token:l,user:i}=n.data;if(o&&l&&i){let t=d(i);return localStorage.setItem("auth_token",l),e({user:t,loading:!1,error:null}),!0}return e({error:n.data.message||"認証に失敗しました",loading:!1}),!1}catch(t){return localStorage.removeItem("auth_token"),e({user:null,error:"認証に失敗しました",loading:!1}),!1}},logout:()=>{localStorage.removeItem("auth_token"),e({user:null,loading:!1,error:null})},setInitialized:t=>e({initialized:t})}))?s(n):s},6579:function(){},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),o=Symbol.for("react.element"),l=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,r){var n,l={},u=null,c=null;for(n in void 0!==r&&(u=""+r),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)i.call(t,n)&&!s.hasOwnProperty(n)&&(l[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===l[n]&&(l[n]=t[n]);return{$$typeof:o,type:e,key:u,ref:c,props:l,_owner:a.current}}t.Fragment=l,t.jsx=u,t.jsxs=u},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[829,971,596,744],function(){return e(e.s=9316)}),_N_E=e.O()}]);